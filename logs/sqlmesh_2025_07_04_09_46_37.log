2025-07-04 09:46:39,474 - MainThread - sqlmesh.core.config.connection - INFO - Creating new DuckDB adapter for in-memory database (connection.py:453)
2025-07-04 09:46:43,529 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage CreateSnapshotRecordsStage (evaluator.py:119)
2025-07-04 09:46:43,549 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage PhysicalLayerUpdateStage (evaluator.py:119)
2025-07-04 09:46:43,552 - ThreadPoolExecutor-1_0 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema postgres.sqlmesh__smhi (evaluator.py:350)
2025-07-04 09:46:43,553 - ThreadPoolExecutor-1_1 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema postgres.sqlmesh__sqlmesh_example (evaluator.py:350)
2025-07-04 09:46:43,554 - ThreadPoolExecutor-1_2 - sqlmesh.core.snapshot.evaluator - INFO - Listing data objects in schema postgres.sqlmesh__kaggle (evaluator.py:350)
2025-07-04 09:46:43,560 - ThreadPoolExecutor-1_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2244)
2025-07-04 09:46:43,568 - ThreadPoolExecutor-1_1 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2244)
2025-07-04 09:46:43,575 - ThreadPoolExecutor-1_2 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT current_catalog (base.py:2244)
2025-07-04 09:46:43,689 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'postgres.sqlmesh__smhi' (evaluator.py:1143)
2025-07-04 09:46:43,697 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "sqlmesh__smhi" (base.py:2244)
2025-07-04 09:46:43,702 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'postgres.sqlmesh__kaggle' (evaluator.py:1143)
2025-07-04 09:46:43,702 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "sqlmesh__kaggle" (base.py:2244)
2025-07-04 09:46:43,703 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'postgres.sqlmesh__sqlmesh_example' (evaluator.py:1143)
2025-07-04 09:46:43,703 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "sqlmesh__sqlmesh_example" (base.py:2244)
2025-07-04 09:46:43,713 - ThreadPoolExecutor-2_0 - sqlmesh.core.snapshot.evaluator - INFO - Creating table 'postgres.sqlmesh__smhi.smhi__weather_warnings__2806327000' (evaluator.py:1495)
2025-07-04 09:46:43,715 - ThreadPoolExecutor-2_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE TABLE IF NOT EXISTS "sqlmesh__smhi"."smhi__weather_warnings__2806327000" ("warning_id" INT, "event_code" TEXT, "event_en" TEXT, "mho_code" TEXT, "area_id" INT, "area_name" TEXT, "warning_level" TEXT, "event_description" TEXT, "approximate_start" TIMESTAMP, "published" TIMESTAMP, "created" TIMESTAMP) (base.py:2244)
2025-07-04 09:46:43,730 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage BackfillStage (evaluator.py:119)
2025-07-04 09:46:43,734 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Evaluating snapshot SnapshotId<"postgres"."smhi"."weather_warnings": 1382259398> (evaluator.py:636)
2025-07-04 09:46:43,872 - ThreadPoolExecutor-3_0 - sqlmesh.core.snapshot.evaluator - INFO - Inserting batch (2025-07-02 00:00:00, 2025-07-03 00:00:00) into postgres.sqlmesh__smhi.smhi__weather_warnings__2806327000' (evaluator.py:690)
2025-07-04 09:46:43,876 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: SELECT 1 FROM "information_schema"."tables" WHERE "table_name" = 'smhi__weather_warnings__2806327000' AND "table_schema" = 'sqlmesh__smhi' (base.py:2244)
2025-07-04 09:46:43,882 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DELETE FROM "sqlmesh__smhi"."smhi__weather_warnings__2806327000" WHERE TRUE (base.py:2244)
2025-07-04 09:46:43,888 - ThreadPoolExecutor-3_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: INSERT INTO "sqlmesh__smhi"."smhi__weather_warnings__2806327000" ("warning_id", "event_code", "event_en", "mho_code", "area_id", "area_name", "warning_level", "event_description", "approximate_start", "published", "created") SELECT CAST("warning_id" AS INT) AS "warning_id", CAST("event_code" AS TEXT) AS "event_code", CAST("event_en" AS TEXT) AS "event_en", CAST("mho_code" AS TEXT) AS "mho_code", CAST("area_id" AS INT) AS "area_id", CAST("area_name" AS TEXT) AS "area_name", CAST("warning_level" AS TEXT) AS "warning_level", CAST("event_description" AS TEXT) AS "event_description", CAST("approximate_start" AS TIMESTAMP) AS "approximate_start", CAST("published" AS TIMESTAMP) AS "published", CAST("created" AS TIMESTAMP) AS "created" FROM (VALUES "<REDACTED VALUES>") AS "t"("warning_id", "event_code", "event_en", "mho_code", "area_id", "area_name", "warning_level", "event_description", "approximate_start", "published", "created") (base.py:2244)
2025-07-04 09:46:43,902 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.facade - INFO - Adding interval (2025-07-02 00:00:00, 2025-07-03 00:00:00) for snapshot SnapshotId<"postgres"."smhi"."weather_warnings": 1382259398> (facade.py:621)
2025-07-04 09:46:43,902 - ThreadPoolExecutor-3_0 - sqlmesh.core.state_sync.db.interval - INFO - Pushing intervals for snapshot SnapshotId<"postgres"."smhi"."weather_warnings": 1382259398> (interval.py:214)
2025-07-04 09:46:43,916 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage EnvironmentRecordUpdateStage (evaluator.py:119)
2025-07-04 09:46:43,917 - MainThread - sqlmesh.core.state_sync.db.facade - INFO - Promoting environment 'prod' (facade.py:169)
2025-07-04 09:46:43,932 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage UnpauseStage (evaluator.py:119)
2025-07-04 09:46:43,934 - MainThread - sqlmesh.core.state_sync.db.snapshot - INFO - Unpausing snapshot SnapshotId<"postgres"."smhi"."weather_warnings": 1382259398> (snapshot.py:144)
2025-07-04 09:46:43,938 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage VirtualLayerUpdateStage (evaluator.py:119)
2025-07-04 09:46:43,940 - MainThread - sqlmesh.core.snapshot.evaluator - INFO - Creating schema 'postgres.smhi' (evaluator.py:1143)
2025-07-04 09:46:43,941 - MainThread - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE SCHEMA IF NOT EXISTS "smhi" (base.py:2244)
2025-07-04 09:46:43,944 - ThreadPoolExecutor-4_0 - sqlmesh.core.snapshot.evaluator - INFO - Updating view 'postgres.smhi.weather_warnings' to point at table 'postgres.sqlmesh__smhi.smhi__weather_warnings__2806327000' (evaluator.py:1450)
2025-07-04 09:46:43,952 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: DROP VIEW IF EXISTS "smhi"."weather_warnings" CASCADE (base.py:2244)
2025-07-04 09:46:43,954 - ThreadPoolExecutor-4_0 - sqlmesh.core.engine_adapter.base - INFO - Executing SQL: CREATE VIEW "smhi"."weather_warnings" AS SELECT * FROM "postgres"."sqlmesh__smhi"."smhi__weather_warnings__2806327000" (base.py:2244)
2025-07-04 09:46:43,961 - MainThread - sqlmesh.core.plan.evaluator - INFO - Evaluating plan stage FinalizeEnvironmentStage (evaluator.py:119)
2025-07-04 09:46:43,962 - MainThread - sqlmesh.core.state_sync.db.environment - INFO - Finalizing environment 'prod' (environment.py:139)
2025-07-04 09:46:43,967 - MainThread - root - INFO - Shutting down the event dispatcher (dispatcher.py:159)
